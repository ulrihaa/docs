## 28/01/2022: CVE-2021-4034: Polkit's pkexec {#cve-2021-4034}

### Description

Vulnerability [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1) is found in all versions of Unix-like operating systems. The PolicyKit pkexec tool incorrectly handles command-line arguments. An attacker may use this pkexec behavior to escalate privileges to an administrator.

For a detailed description of the vulnerability, see this [article](https://www.openwall.com/lists/oss-security/2022/01/25/11).

Vulnerability description: [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1).

CVSS score: 7.8.

### Impact

#### General impact

The vulnerability affects all the Unix-like operating systems running any policykit-1 (0.105) version lower than specified in the article. See here for [Ubuntu](https://ubuntu.com/security/notices/USN-5252-1).

#### Impact on {{ yandex-cloud }} services

{{ yandex-cloud }} updated its services:

* {{ marketplace-full-name }}.
* {{ yandex-cloud }} internal infrastructure.

We are preparing updates for {{ managed-k8s-full-name }}.

### Compensatory measures

If you are using a cloud-based node group in {{ managed-k8s-full-name }}, wait for the official update for the service and apply it. Alternatively, [update the OS](https://ubuntu.com/security/notices/USN-5252-1) independently.

You can also take the compensatory measures:

* Use a [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2021-4034) for this vulnerability from yc-solution-library-for-security. It sets the settings according to Ubuntu recommendations.

* Follow the official update or vulnerability compensation guidelines for images from {{ marketplace-full-name }} or your own images in {{ compute-full-name }}. For example, set access rights for Ubuntu: `chmod 0755 /usr/bin/pkexec`.