## 28/01/2022: CVE-2022-0185: Heap overflow bug in legacy_parse_param {#CVE-2022-0185}

### Description

Vulnerability [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185) is found in Linux kernel versions from 5.1-rc1, in the file system context functionality. An attacker may use this to cause a denial of service (system crash), execute arbitrary code, and go out of container bounds.

For a detailed description of the vulnerability, see this [article](https://sysdig.com/blog/cve-2022-0185-container-escape/).

Vulnerability description: [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185).

CVSS score: 7.8.

### Impact

#### General impact

This vulnerability affects Linux Kernel systems around the world that run kernel versions 5.1-rc1 to 5.16.

#### Impact on {{ yandex-cloud }} services

{{ yandex-cloud }} updated its services:

* {{ marketplace-full-name }}.
* {{ yandex-cloud }} internal infrastructure.

We are preparing updates for {{ managed-k8s-full-name }}.

### Compensatory measures

If you are using a cloud node group in {{ managed-k8s-full-name }}, wait for the official update for the service and apply it. Alternatively, [update the OS](https://ubuntu.com/security/notices/USN-5240-1) independently.

You can also take the compensatory measures:

* Use a [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2022-0185) for this vulnerability from yc-solution-library-for-security. It sets the settings according to Ubuntu recommendations.
* Follow the official update or vulnerability compensation guidelines for your Linux distribution. For example, set `sysctl -w kernel.unprivileged_userns_clone=0` for Ubuntu.
* Use seccomp in Kubernetes as described in this [article](https://kubernetes.io/docs/tutorials/security/seccomp/).
* Do not assign redundant capabilities and use [the k8s security section](../../../security/domains/checklist.md#kubernetes-secure-configuration) from our checklist for monitoring them.