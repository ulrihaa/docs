## 06/10/2023: CVE-2023-35941 OAuth2 credentials exploit with permanent validity {#CVE-2023-35941}

CVE ID: CVE-2023-35941

Link to CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-35941>

### Original report {#original-report}

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-7mhv-gr67-hq55>

### Summary {#brief-description}

Prior to versions 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12, malicious clients could construct OAuth2 credentials with permanent validity. This was caused by some rare scenarios when a HMAC payload could be always valid in the OAuth2 filter's check. As a workaround, avoid wildcards/prefix domain wildcards in the host domain configuration.

### Technologies affected {#technologies-affected}

Envoy

### Vulnerable products and versions {#vulnerable-products-and-versions}

Envoy, versions prior to 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12.

### Vendor {#vendor}

Envoy

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

CVSS score: 9.8. Attack vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

We recommend updating to the latest version. If it is not possible, do not use wildcards/prefix domain wildcards in the host domain configuration.

### Safe version of vulnerable product or patch {#safe-version}

Vulnerability fixed in versions 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

We updated current and upcoming images to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.
