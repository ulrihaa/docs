## 06/10/2023: CVE-2023-35943 CORS filter segfault when origin header is removed {#CVE-2023-35943}

CVE ID: CVE-2023-35943

Link to CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-35943>

### Original report {#original-report}

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-mc6h-6j9x-v3gq>

### Summary {#brief-description}

Prior to versions 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12, the CORS filter would segfault and crash Envoy when the `origin` header was removed and deleted between `decodeHeaders` and `encodeHeaders`. The issue is fixed in versions 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12.

### Technologies affected {#technologies-affected}

Envoy

### Vulnerable products and versions {#vulnerable-products-and-versions}

Envoy, versions prior to 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12.

### Vendor {#vendor}

Envoy

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

CVSS score: 7.5. Attack vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

We recommend updating to the latest version. If it is not possible, do not remove the `origin` header in the Envoy configuration.

### Safe version of vulnerable product or patch {#safe-version}

Vulnerability fixed in versions 1.27.0, 1.26.4, 1.25.9, 1.24.10, and 1.23.12.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

We updated current and upcoming images to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.
