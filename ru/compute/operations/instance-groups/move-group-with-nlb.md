---
title: "Перенос группы виртуальных машин с сетевым балансировщиком в другую зону доступности"
description: "Из статьи вы узнаете, как можно перенести группу ВМ {{ compute-name }} с сетевым балансировщиком нагрузки из одной зоны доступности в другую."
---

# Перенести группу виртуальных машин c сетевым балансировщиком нагрузки в другую зону доступности


{% note info %}

{% include [zone-c-deprecation](../../../_includes/vpc/zone-c-deprecation.md) %}

{% endnote %}


Чтобы перенести группу ВМ c [сетевым балансировщиком нагрузки](../../../network-load-balancer/concepts) {{ network-load-balancer-full-name }}:
1. [Создайте](../../../vpc/operations/subnet-create.md) подсеть в зоне доступности, в которую вы хотите перенести группу ВМ.
1. Добавьте ВМ группы в новую зону доступности:

    {% include [ig-create-in-another-zone](../../../_includes/compute/ig-create-in-another-zone.md) %}

1. В зависимости от [типа](../../../network-load-balancer/concepts/nlb-types.md) балансировщика, выполните следующие действия:

    * **Внешний балансировщик** (`EXTERNAL`):
      
      1. Дождитесь пока ресурсы целевой группы в новой зоне доступности пройдут [проверку состояния](../../../network-load-balancer/concepts/health-check.md) и перейдут в статус `HEALTHY`. См. [{#T}](../../../network-load-balancer/operations/check-resource-health.md).
    
          После этого новая зона доступности будет включена в маршрутизацию трафика через балансировщик. Этот процесс может занимать до 2 минут. См. [Сходимость маршрутизации в зоне доступности](../../../network-load-balancer/concepts/specifics.md#nlb-zone-converge).

      1. Удалите ВМ группы из старой зоны доступности:

          {% include [ig-delete-in-zone.md](../../../_includes/compute/ig-delete-in-zone.md) %}

    * **Внутренний балансировщик** (`INTERNAL`):

      1. Перенесите ресурсы, которым нужен доступ к внутреннему балансировщику, в подсеть, созданную ранее.
      1. Удалите ВМ группы из старой зоны доступности:

          {% include [ig-delete-in-zone.md](../../../_includes/compute/ig-delete-in-zone.md) %}
      1. Убедитесь, что в подсети в старой зоне доступности не осталось ресурсов.
      1. Перенесите подсеть в новую зону доступности:
      
          {% list tabs %}

          - CLI
          
            {% include [cli-install.md](../../../_includes/cli-install.md) %}

            {% include [default-catalogue.md](../../../_includes/default-catalogue.md) %}

            1. Получите список всех подсетей в каталоге:

                ```bash
                yc vpc subnet list
                ```

                Результат:

                ```text
                +----------------------+-----------------------+----------------------+----------------------+---------------+-----------------+
                |          ID          |         NAME          |      NETWORK ID      |    ROUTE TABLE ID    |     ZONE      |      RANGE      |
                +----------------------+-----------------------+----------------------+----------------------+---------------+-----------------+
                | b0c1eb4nbv47******** | default-{{ region-id }}-c | enpgf5vu9dd7******** |                      | {{ region-id }}-c | [10.130.0.0/24] |
                | e2lube0qahmf******** | default-{{ region-id }}-b | enpgf5vu9dd7******** |                      | {{ region-id }}-b | [10.129.0.0/24] |
                | e9bj3s90g9hm******** | default-{{ region-id }}-a | enpgf5vu9dd7******** | enpckj4hqdid******** | {{ region-id }}-a | [10.128.0.0/24] |
                +----------------------+-----------------------+----------------------+----------------------+---------------+-----------------+
                ```

                Сохраните идентификатор (`ID`) подсети, которую вы хотите перенести в другую зону доступности.

            1. Чтобы перенести подсеть в другую зону доступности, выполните команду, указав идентификатор подсети и новую зону доступности:

                ```bash
                yc vpc subnet relocate <идентификатор_подсети> \
                  --destination-zone-id <новая_зона_доступности>
                ```

                Результат:

                ```yaml
                id: b0c5nguttpcq********
                folder_id: b1gsm0k26v1l********
                created_at: "2023-10-25T07:43:59Z"
                name: default-{{ region-id }}-c
                network_id: b0c1eb4nbv47********
                zone_id: {{ region-id }}-b
                v4_cidr_blocks:
                  - 10.130.0.0/24
                hcp_options: {}
                ```

          {% endlist %}

          Вместе с подсетью в новую зону доступности будут перенесены обработчики внутреннего балансировщика.
          
          После этого новая зона доступности будет включена в маршрутизацию трафика через балансировщик. Этот процесс может занимать до 2 минут. См. [Сходимость маршрутизации в зоне доступности](../../../network-load-balancer/concepts/specifics.md#nlb-zone-converge).

      1. Переместите ресурсы, которым нужен доступ к внутреннему балансировщику, в подсеть, которую вы перенесли из старой зоны доступности, или [настройте](../../../vpc/operations/static-route-create.md) статическую маршрутизацию к нему.
